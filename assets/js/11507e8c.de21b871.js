"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3001],{8800:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"interfaces/use-custom-msg-py","title":"Creating and Using Custom Messages in ROS2 with Python","description":"In this tutorial, we will cover the steps required to create a custom message in ROS2 and use it within a Python node. This will include setting up the custom message, writing the Python publisher node, and configuring the development environment to recognize the new message type.","source":"@site/docs/05_interfaces/04_use-custom-msg-py.md","sourceDirName":"05_interfaces","slug":"/interfaces/use-custom-msg-py","permalink":"/docs/interfaces/use-custom-msg-py","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/05_interfaces/04_use-custom-msg-py.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ROS2 Custom Message: Python and C++ Integration","permalink":"/docs/interfaces/use-custom-msg-cpp"},"next":{"title":"Creating and Building a Custom ROS2 Service","permalink":"/docs/interfaces/create-build-custom-srv"}}');var t=n(4848),i=n(8453);const a={},o="Creating and Using Custom Messages in ROS2 with Python",c={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Creating the Custom Message",id:"step-1-creating-the-custom-message",level:2},{value:"Step 2: Creating the Python Node",id:"step-2-creating-the-python-node",level:2},{value:"Step 3: Configuring the Environment",id:"step-3-configuring-the-environment",level:2},{value:"Step 4: Running the Publisher Node",id:"step-4-running-the-publisher-node",level:2},{value:"Common Issues",id:"common-issues",level:2},{value:"Import Errors in VS Code",id:"import-errors-in-vs-code",level:3},{value:"Source Your Workspace",id:"source-your-workspace",level:3}];function l(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"creating-and-using-custom-messages-in-ros2-with-python",children:"Creating and Using Custom Messages in ROS2 with Python"})}),"\n",(0,t.jsx)(s.p,{children:"In this tutorial, we will cover the steps required to create a custom message in ROS2 and use it within a Python node. This will include setting up the custom message, writing the Python publisher node, and configuring the development environment to recognize the new message type."}),"\n",(0,t.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(s.p,{children:"Before starting, ensure you have the following:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"A working ROS2 installation"}),"\n",(0,t.jsx)(s.li,{children:"A workspace set up for ROS2"}),"\n",(0,t.jsx)(s.li,{children:"Basic familiarity with ROS2 concepts such as nodes, topics, and messages"}),"\n",(0,t.jsx)(s.li,{children:"Basic knowledge of Python"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"step-1-creating-the-custom-message",children:"Step 1: Creating the Custom Message"}),"\n",(0,t.jsx)(s.p,{children:"First, create a new package for your custom messages if you haven't already. Navigate to your ROS2 workspace:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"cd ~/ros2_ws/src\n"})}),"\n",(0,t.jsx)(s.p,{children:"Create a new package for your custom interfaces:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"ros2 pkg create --build-type ament_cmake my_robot_interfaces\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Inside this package, create a ",(0,t.jsx)(s.code,{children:"msg"})," directory and add your custom message file, ",(0,t.jsx)(s.code,{children:"HardwareStatus.msg"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"mkdir -p my_robot_interfaces/msg\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Create the ",(0,t.jsx)(s.code,{children:"HardwareStatus.msg"})," file with the following content:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"int32 temperature\nbool motor_ready\nstring debug_message\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Update the ",(0,t.jsx)(s.code,{children:"CMakeLists.txt"})," file in your ",(0,t.jsx)(s.code,{children:"my_robot_interfaces"})," package to include the new message:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-cmake",children:'find_package(ament_cmake REQUIRED)\nfind_package(rosidl_default_generators REQUIRED)\n\nrosidl_generate_interfaces(my_robot_interfaces\n  "msg/HardwareStatus.msg"\n)\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Also, update the ",(0,t.jsx)(s.code,{children:"package.xml"})," file to include dependencies on ",(0,t.jsx)(s.code,{children:"rosidl_default_generators"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-xml",children:"<buildtool_depend>ament_cmake</buildtool_depend>\n<build_depend>rosidl_default_generators</build_depend>\n<exec_depend>rosidl_default_runtime</exec_depend>\n"})}),"\n",(0,t.jsx)(s.p,{children:"Now, build your package:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"cd ~/ros2_ws\ncolcon build --packages-select my_robot_interfaces\nsource install/setup.bash\n"})}),"\n",(0,t.jsx)(s.h2,{id:"step-2-creating-the-python-node",children:"Step 2: Creating the Python Node"}),"\n",(0,t.jsx)(s.p,{children:"Create a new Python package if you haven't already:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"ros2 pkg create --build-type ament_python my_python_package\n"})}),"\n",(0,t.jsx)(s.p,{children:"Navigate to your package and create a directory for your nodes:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"cd my_python_package\nmkdir -p my_python_package\ntouch my_python_package/hardware_status_publisher.py\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Edit ",(0,t.jsx)(s.code,{children:"setup.py"})," to include the new script:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"entry_points={\n    'console_scripts': [\n        'hardware_status_publisher = my_python_package.hardware_status_publisher:main'\n    ],\n},\n"})}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.code,{children:"my_python_package"})," directory, create the ",(0,t.jsx)(s.code,{children:"hardware_status_publisher.py"})," file with the following content:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom my_robot_interfaces.msg import HardwareStatus\n\nclass HardwareStatusPublisher(Node):\n\n    def __init__(self):\n        super().__init__('hardware_status_publisher')\n        self.publisher_ = self.create_publisher(HardwareStatus, 'hardware_status', 10)\n        timer_period = 1.0  # seconds\n        self.timer = self.create_timer(timer_period, self.publish_status)\n        self.get_logger().info('Hardware Status Publisher Node has been started.')\n\n    def publish_status(self):\n        msg = HardwareStatus()\n        msg.temperature = 45\n        msg.motor_ready = True\n        msg.debug_message = 'All systems operational'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: {msg}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = HardwareStatusPublisher()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(s.h2,{id:"step-3-configuring-the-environment",children:"Step 3: Configuring the Environment"}),"\n",(0,t.jsxs)(s.p,{children:["Make sure the ",(0,t.jsx)(s.code,{children:"my_robot_interfaces"})," package is added as a dependency in the ",(0,t.jsx)(s.code,{children:"package.xml"})," of your Python package:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-xml",children:"<exec_depend>my_robot_interfaces</exec_depend>\n"})}),"\n",(0,t.jsx)(s.p,{children:"Rebuild your workspace to ensure all dependencies are met:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"cd ~/ros2_ws\ncolcon build\nsource install/setup.bash\n"})}),"\n",(0,t.jsx)(s.h2,{id:"step-4-running-the-publisher-node",children:"Step 4: Running the Publisher Node"}),"\n",(0,t.jsx)(s.p,{children:"You can now run the publisher node:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"ros2 run my_python_package hardware_status_publisher\n"})}),"\n",(0,t.jsx)(s.p,{children:"Verify the node and topic:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"ros2 node list\nros2 topic list\n"})}),"\n",(0,t.jsx)(s.p,{children:"Check the topic information:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"ros2 topic info /hardware_status\n"})}),"\n",(0,t.jsx)(s.p,{children:"To see the published messages:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"ros2 topic echo /hardware_status\n"})}),"\n",(0,t.jsx)(s.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,t.jsx)(s.h3,{id:"import-errors-in-vs-code",children:"Import Errors in VS Code"}),"\n",(0,t.jsx)(s.p,{children:"If you encounter import errors in VS Code, ensure the Python interpreter is aware of your custom messages by adding the appropriate path in VS Code settings:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Open VS Code settings (",(0,t.jsx)(s.code,{children:"Ctrl + ,"}),")."]}),"\n",(0,t.jsxs)(s.li,{children:["Search for ",(0,t.jsx)(s.code,{children:"Python: Auto Complete Extra Paths"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["Add the path to your ROS2 message packages, e.g., ",(0,t.jsx)(s.code,{children:"/path/to/ros2_ws/install/my_robot_interfaces/lib/python3.8/site-packages"}),"."]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"source-your-workspace",children:"Source Your Workspace"}),"\n",(0,t.jsx)(s.p,{children:"Always ensure your workspace is sourced correctly:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-sh",children:"source ~/ros2_ws/install/setup.bash\n"})}),"\n",(0,t.jsx)(s.p,{children:"This ensures that your custom messages and nodes are recognized by the ROS2 environment."}),"\n",(0,t.jsx)(s.p,{children:"By following these steps, you have created a custom message, written a Python node to publish this message, and configured your environment to recognize and use this custom message. This process can be applied to any custom message type you wish to create and use within your ROS2 applications."})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>o});var r=n(6540);const t={},i=r.createContext(t);function a(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);