"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4838],{7822:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"services/service-server-py","title":"service-server-py","description":"Creating a Service Server in ROS 2","source":"@site/docs/04_services/03_service-server-py.md","sourceDirName":"04_services","slug":"/services/service-server-py","permalink":"/docs/services/service-server-py","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/04_services/03_service-server-py.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Services","permalink":"/docs/services/definition"},"next":{"title":"Interfaces","permalink":"/docs/category/interfaces"}}');var i=s(4848),t=s(8453);const c={},d=void 0,o={},a=[{value:"Creating a Service Server in ROS 2",id:"creating-a-service-server-in-ros-2",level:2},{value:"Introduction",id:"introduction",level:3},{value:"Step 1: Understanding ROS 2 Services",id:"step-1-understanding-ros-2-services",level:3},{value:"Step 2: Using an Existing Service Type",id:"step-2-using-an-existing-service-type",level:3},{value:"Step 3: Setting Up the Workspace",id:"step-3-setting-up-the-workspace",level:3},{value:"Step 4: Creating the Service Server Node",id:"step-4-creating-the-service-server-node",level:3},{value:"Step 5: Writing the Service Server Code",id:"step-5-writing-the-service-server-code",level:3},{value:"Step 6: Explanation of the Code",id:"step-6-explanation-of-the-code",level:3},{value:"Step 7: Building and Running the Service",id:"step-7-building-and-running-the-service",level:3},{value:"Step 8: Testing the Service",id:"step-8-testing-the-service",level:3},{value:"Conclusion",id:"conclusion",level:3}];function l(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"creating-a-service-server-in-ros-2",children:"Creating a Service Server in ROS 2"}),"\n",(0,i.jsx)(n.h3,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"In this tutorial, we will develop a service server in Python using ROS 2. This server will accept two integers as input and return their sum as output. We will walk through the process step by step, ensuring all concepts are thoroughly explained and accurately implemented."}),"\n",(0,i.jsx)(n.h3,{id:"step-1-understanding-ros-2-services",children:"Step 1: Understanding ROS 2 Services"}),"\n",(0,i.jsx)(n.p,{children:"A service in ROS 2 is defined by two main components:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Service Name:"})," This acts as a common interface between nodes, allowing them to find and utilize the service."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Service Type:"})," This defines the request and response structure for the service."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-using-an-existing-service-type",children:"Step 2: Using an Existing Service Type"}),"\n",(0,i.jsxs)(n.p,{children:["For this tutorial, we will use an existing service type, ",(0,i.jsx)(n.code,{children:"AddTwoInts"}),", provided by ROS 2. You can inspect available interfaces using:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"ros2 interface show example_interfaces/srv/AddTwoInts\n"})}),"\n",(0,i.jsx)(n.p,{children:"This command will display the request and response structure:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Request: Two integers, ",(0,i.jsx)(n.code,{children:"a"})," and ",(0,i.jsx)(n.code,{children:"b"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Response: One integer, ",(0,i.jsx)(n.code,{children:"sum"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-3-setting-up-the-workspace",children:"Step 3: Setting Up the Workspace"}),"\n",(0,i.jsx)(n.p,{children:"Navigate to your ROS 2 workspace and create a new directory for the service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"cd ~/ros2_ws/src/\nmkdir -p my_service_package/my_service\ncd my_service_package/my_service\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-creating-the-service-server-node",children:"Step 4: Creating the Service Server Node"}),"\n",(0,i.jsx)(n.p,{children:"Create a new Python file for the service server:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"touch add_two_ints_server.py\nchmod +x add_two_ints_server.py\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-5-writing-the-service-server-code",children:"Step 5: Writing the Service Server Code"}),"\n",(0,i.jsxs)(n.p,{children:["Open ",(0,i.jsx)(n.code,{children:"add_two_ints_server.py"})," in your preferred text editor and add the following code:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass AddTwoIntsServer(Node):\n    def __init__(self):\n        super().__init__('add_two_ints_server')\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n        self.get_logger().info('AddTwoInts server has been started.')\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info(f'Request: {request.a} + {request.b} = {response.sum}')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = AddTwoIntsServer()\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-6-explanation-of-the-code",children:"Step 6: Explanation of the Code"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Imports:"})," Import the necessary modules and service type."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Class Definition:"})," Define the ",(0,i.jsx)(n.code,{children:"AddTwoIntsServer"})," class, inheriting from ",(0,i.jsx)(n.code,{children:"Node"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Service Creation:"})," In the constructor, create the service using ",(0,i.jsx)(n.code,{children:"self.create_service"}),". The arguments are:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AddTwoInts"}),": The service type."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"'add_two_ints'"}),": The service name."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"self.add_two_ints_callback"}),": The callback function to handle the request."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Callback Function:"})," The callback function ",(0,i.jsx)(n.code,{children:"add_two_ints_callback"})," processes the request by adding the two integers and returning the sum."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Main Function:"})," Initialize the ROS 2 system, create the node, and keep it running until interrupted."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"step-7-building-and-running-the-service",children:"Step 7: Building and Running the Service"}),"\n",(0,i.jsx)(n.p,{children:"Navigate back to your workspace root and build the package:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"cd ~/ros2_ws/\ncolcon build --packages-select my_service_package\n"})}),"\n",(0,i.jsx)(n.p,{children:"Source the setup file and run the service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:". install/setup.bash\nros2 run my_service_package add_two_ints_server\n"})}),"\n",(0,i.jsx)(n.p,{children:"You should see a log message indicating the server has started."}),"\n",(0,i.jsx)(n.h3,{id:"step-8-testing-the-service",children:"Step 8: Testing the Service"}),"\n",(0,i.jsx)(n.p,{children:"In a new terminal, call the service using the ROS 2 command-line tool:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'ros2 service call /add_two_ints example_interfaces/srv/AddTwoInts "{a: 3, b: 4}"\n'})}),"\n",(0,i.jsx)(n.p,{children:"You should see the server log the request and response:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Request: 3 + 4 = 7\n"})}),"\n",(0,i.jsx)(n.h3,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsx)(n.p,{children:"You have successfully created and tested a ROS 2 service server. This server can handle requests to add two integers and return their sum. This fundamental understanding can now be extended to creating more complex services and custom service types in ROS 2."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var r=s(6540);const i={},t=r.createContext(i);function c(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);